<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AnalysisTree: AnalysisTree</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">AnalysisTree
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title"><a class="el" href="d9/d26/namespaceAnalysisTree.html" title="Cuts keep list of SimpleCuts. Logical AND is applied for all SimpleCut in the Cuts object.">AnalysisTree</a> </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a></p>
<p><img src="https://github.com/HeavyIonAnalysis/AnalysisTree/workflows/CMake/badge.svg" alt="Workflow status" style="pointer-events: none;" class="inline"/> <img src="https://img.shields.io/github/v/tag/HeavyIonAnalysis/AnalysisTree?sort=semver" alt="GitHub tag (latest SemVer)" class="inline"/> <img src="https://img.shields.io/github/v/release/HeavyIonAnalysis/AnalysisTree" alt="GitHub release (latest SemVer)" class="inline"/></p>
<h1>Important note on <a class="el" href="d9/d26/namespaceAnalysisTree.html" title="Cuts keep list of SimpleCuts. Logical AND is applied for all SimpleCut in the Cuts object.">AnalysisTree</a> versions</h1>
<p><b>Current version is development version!</b></p>
<p>Last tested version: v2.3.2</p>
<p>Last release version: v.2.3.2</p>
<p>Different MAJOR version means incompatible API changes. Neither API nor data compatibility is preserved between MAJOR versions.</p>
<p>Since v2.2.1 old infra implementation is kept for the sake of code compatibility until the next MAJOR infra release.</p>
<h1>Doxygen documentation:</h1>
<p><a href="https://heavyionanalysis.github.io/AnalysisTree/">https://heavyionanalysis.github.io/AnalysisTree/</a></p>
<h1>General information</h1>
<p>This is a dataformat to store information in configurable objects. Basic objects are:<br  />
</p><ul>
<li>Track (momentum)<br  />
</li>
<li>Particle (momentum and PID)<br  />
</li>
<li>Hit (position and signal)<br  />
</li>
<li>Module (id and signal)<br  />
 Four mentioned objects are so-called channelized: they contain set of channels (namely tracks, prticles, hits or modules) in each event<br  />
</li>
<li>EventHeader (vertex position) - contains information related to specific event<br  />
</li>
<li>DataHeader - contains common information for all events<br  />
</li>
<li>Matching - establishes a correspondence between channels in channelized objects (e.g. between simulated particle and reconstructed track).</li>
</ul>
<p>Additionaly to mandatory information specified in round brackets (a.k.a. "default fileds"), each object can contain any number of integer, floating or boolean fields (a.k.a. "user-defined fields"). Information about all fields in all branches is stored in Configuration object.</p>
<h1>Installation</h1>
<p>ROOT6 is needed for installation. Follow CERN ROOT <a href="https://root.cern/install/">instructions</a> to install it. Version compiled with c++17 flag is preferred, otherwise CMAKE_CXX_STANDARD flag needs to be explicitly specified (see below). </p><pre class="fragment">git clone https://github.com/HeavyIonAnalysis/AnalysisTree.git
cd AnalysisTree
mkdir build install
cd build
source path-to-root-installation/bin/thisroot.sh
cmake -DCMAKE_INSTALL_PREFIX=../install ../
make -j install
</pre><p><em>path-to-root-installation</em> must be replaced with your actual location of Root install directory.</p>
<h2>List of CMake options:</h2>
<p>To apply the flag use -D{Name}={value}, for example, if you want to compile using c++11: </p><pre class="fragment">cmake -DCMAKE_CXX_STANDARD=11 ../
</pre><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name   </th><th class="markdownTableHeadNone">Default value   </th><th class="markdownTableHeadNone">Possible values    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CMAKE_BUILD_TYPE   </td><td class="markdownTableBodyNone">RELEASE   </td><td class="markdownTableBodyNone">RELEASE/DEBUG    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">CMAKE_CXX_STANDARD   </td><td class="markdownTableBodyNone">17   </td><td class="markdownTableBodyNone">11/14/17    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">AnalysisTree_BUILD_TESTS   </td><td class="markdownTableBodyNone">OFF   </td><td class="markdownTableBodyNone">ON/OFF    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">AnalysisTree_BUILD_EXAMPLES   </td><td class="markdownTableBodyNone">OFF   </td><td class="markdownTableBodyNone">ON/OFF    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">AnalysisTree_BUILD_INFRA_1   </td><td class="markdownTableBodyNone">OFF   </td><td class="markdownTableBodyNone">ON/OFF   </td></tr>
</table>
<h1>Operating with <a class="el" href="d9/d26/namespaceAnalysisTree.html" title="Cuts keep list of SimpleCuts. Logical AND is applied for all SimpleCut in the Cuts object.">AnalysisTree</a></h1>
<h2>Setting <a class="el" href="d9/d26/namespaceAnalysisTree.html" title="Cuts keep list of SimpleCuts. Logical AND is applied for all SimpleCut in the Cuts object.">AnalysisTree</a> environment</h2>
<p>Whatever you are going to do with <a class="el" href="d9/d26/namespaceAnalysisTree.html" title="Cuts keep list of SimpleCuts. Logical AND is applied for all SimpleCut in the Cuts object.">AnalysisTree</a> - read the file, perform analysis based on information stored in it or create your own file, first of all you need to set up environment variables. It can be done in a single command: </p><pre class="fragment">source path-to-analysis_tree-installation/bin/AnalysisTreeConfig.sh
</pre><h2>Reading files from ROOT session</h2>
<p>An example of <a class="el" href="d9/d26/namespaceAnalysisTree.html" title="Cuts keep list of SimpleCuts. Logical AND is applied for all SimpleCut in the Cuts object.">AnalysisTree</a> ROOT file can be downloaded by this <a href="https://sf.gsi.de/f/3ba5a9e3ff5248edba2c/?dl=1">link</a></p>
<p>Open a ROOT-file </p><pre class="fragment">root -l 1.analysistree.root
</pre><p>Check its content </p><pre class="fragment">.ls
</pre><p>You will obtain something like this: </p><pre class="fragment">TFile**     1.analysistree.root
 TFile*     1.analysistree.root
  KEY: TTree    rTree;1 AnalysisTree
  KEY: AnalysisTree::Configuration  Configuration;1
  KEY: AnalysisTree::DataHeader DataHeader;1
</pre><p>So, file contains ROOT::TTree object named <em>rTree</em>, <a class="el" href="d8/dee/classAnalysisTree_1_1Configuration.html" title="A class to store configuration of the whole AnalysisTree object.">AnalysisTree::Configuration</a> object named <em>Configuration</em> describing the structure and hierarchy of the tree and thus needed for proper reading the tree and, finally, <a class="el" href="d8/d77/classAnalysisTree_1_1DataHeader.html">AnalysisTree::DataHeader</a> object named <em>DataHeader</em> containing information common for all events.</p>
<h3>Reading the configuration</h3>
<p>In order to know the structure of the tree, perform following command: </p><pre class="fragment">Configuration-&gt;Print()
</pre><p>An output will contain plenty of branches and matchings between them. Let us look at one of them:</p>
<p><img src="https://github.com/HeavyIonAnalysis/AnalysisTree/blob/master/docs/pics/SimParticles.png" alt="" class="inline"/></p>
<p>There are listed integer, floating and boolean fields of this branch (boolean are empty in this particular case). In the left column there is a unique id of the field. Pay attention that the numeration of fields is separate for integers, floats and bools. Negative ids belong to default fields of branches while positive ids and 0 - to user-defined fields. Middle column contains string name of the field, and right column - a description of it.</p>
<h3>Digesting the tree content</h3>
<pre class="fragment">Configuration-&gt;GetBranchConfig("SimParticles").GetType()
// to know to which type (Hit, Track, Module, Particle or EventHeader belongs SimParticles branch)

rTree-&gt;Draw("SimParticles.channels_.GetPx()")
// draw distribution of the value contained in the default field (has its own getter, namely
// GetPx(), names of getters can be found in doxygen documentation)

rTree-&gt;Draw("SimParticles.channels_.GetField&lt;int&gt;(2)")
// draw distribution of the value contained in the user-defined field (specify int, float or bool
// in angular brackets and field's id as an argument in round brackets)

// Note that access to default fields is also possible via id, not only via getters:
rTree-&gt;Draw("SimParticles.channels_.GetField&lt;float&gt;(-7)")

// If the branch contains non-channelized objects, but is an EventHeader, the word "channels_"
// is not needed in the command:
rTree-&gt;Draw("SimEventHeader.GetVertexY()")
rTree-&gt;Draw("RecEventHeader.GetField&lt;int&gt;(0)")

// The Draw() method allows usage of ROOT::TTree-specific drawing features such as:

rTree-&gt;Draw("SimParticles.channels_.GetPx() : SimParticles.channels_.GetPy()")
// drawing a 2D histogram, but only for fields from the same branch.

rTree-&gt;Draw("SimParticles.channels_.GetPx()", "SimParticles.channels_.GetPid()==211")
// drawing with some additional condition (px for positive pions only)

rTree-&gt;Draw("SimParticles.channels_.GetPx()", "", "same")
// drawing with user-specified draw options

rTree-&gt;Draw("SimParticles.channels_.GetPx()&gt;&gt;hist(1000,-10,10)")
// drawing a histogram with user-defined binning and ranges.

rTree-&gt;Draw("TMath::Log(TMath::Abs(SimParticles.channels_.GetPx()))")
// drawing a distribution of derived quantites calculated by formula
</pre><p>Moreover, for default fields which are explicitly present in Container (i.e. px is OK, but not pt, which is not stored but calculated on fly) there is a possibility to draw them using TTree::Draw syntax: </p><pre class="fragment">rTree-&gt;Draw("SimParticles.px_")
rTree-&gt;Draw("TMath::Log(TMath::Abs(SimParticles.px_))")
rTree-&gt;Draw("TMath::Log(TMath::Abs(SimParticles.px_)) * TMath::Cos(SimParticles.py_)")
</pre><p>Also you can open a ROOT interactive session and create an <a class="el" href="d7/d86/classAnalysisTree_1_1Chain.html">AnalysisTree::Chain</a>: </p><pre class="fragment">AnalysisTree::Chain t("1.analysistree.root", "rTree") // Chain constructor with a single file
// or
AnalysisTree::Chain t({"filelist.txt"}, {"rTree"})  // Chain constructor with a file list
</pre><p>and then build any fields including user-defined and implicitly present fields (such as phi or pt): </p><pre class="fragment">t.Draw("SimParticles.px")
t.Draw("SimParticles.pid")
t.Draw("VtxTracks.chi2")
// 2D histograms, cuts, drawing options and math formulas mentioned above are also available
</pre><h2>Reading file with a macro</h2>
<p>Building of distributions in interactive mode is a good approach only if the commands are simple, and the number of events to be analized is not so big. However it is not common to do it interactively if formulae you want to use are complicated, and you can easely introduce a typo. Or if your logic includes a matching between branches - then interactive building distributions is totally impossible. For this case a good solution is usage of macros. A comprehensive example of reading the <a class="el" href="d9/d26/namespaceAnalysisTree.html" title="Cuts keep list of SimpleCuts. Logical AND is applied for all SimpleCut in the Cuts object.">AnalysisTree</a> ROOT file is shown in <a href="https://github.com/HeavyIonAnalysis/AnalysisTree/blob/master/examples/ReadingMacro.C">examples/ReadingMacro.C</a>.</p>
<h2>Creating your own <a class="el" href="d9/d26/namespaceAnalysisTree.html" title="Cuts keep list of SimpleCuts. Logical AND is applied for all SimpleCut in the Cuts object.">AnalysisTree</a> file</h2>
<p>A comprehensive example of creating the <a class="el" href="d9/d26/namespaceAnalysisTree.html" title="Cuts keep list of SimpleCuts. Logical AND is applied for all SimpleCut in the Cuts object.">AnalysisTree</a> ROOT file is shown in <a href="https://github.com/HeavyIonAnalysis/AnalysisTree/blob/master/examples/WritingMacro.C">examples/WritingMacro.C</a>.</p>
<h2>Reading and writing with executable</h2>
<p>Usage of compiled code instead of macros has some advantachges, in first turn computation speed, and also syntax check in compile time. Macros can be re-qritten into executables. For this purpose one needs: </p><pre class="fragment">1. Put necessary headers with #include command
2. Create an int main() function - an entry point of any C++ program
3. Add an executable into CMakeLists
</pre><p>An example how to do it is shown with <a href="https://github.com/HeavyIonAnalysis/AnalysisTree/blob/master/examples/UserTaskRead.cpp">examples/UserTaskRead.cpp</a> and <a href="https://github.com/HeavyIonAnalysis/AnalysisTree/blob/master/examples/UserTaskWrite.cpp">examples/UserTaskWrite.cpp</a>.</p>
<p>Note: these examples use a little bit different syntax from one shown in examples above. It is a so-called syntax sugar - attempt to make syntax more user-friendly. However it has its own price in terms of performance - it is slower by factor of few units than one shown above.</p>
<h2>QA of files</h2>
<p>For a QA of the file(s) please use the dedicated package AnalysisTreeQA:<br  />
 <a href="https://github.com/HeavyIonAnalysis/AnalysisTreeQA">https://github.com/HeavyIonAnalysis/AnalysisTreeQA</a></p>
<h1>Known problems (features)</h1>
<ul>
<li>BranchConfig::GetFieldId() is slow -&gt; should not be used for every event/track/hit/module</li>
<li>In some systems (e.g. at MacOS) there is a linking problem when using AnalysisTree::Infra objects in interactive mode or in macros. However it is easely fixable by silent call an AnalysisTree::Base object, e.g. <a class="el" href="de/dce/classAnalysisTree_1_1Hit.html">AnalysisTree::Hit()</a> - without doing nothing with it, just call. </li>
</ul>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2
</small></address>
</div><!-- doc-content -->
</body>
</html>
